{% extends "auctions/layout.html" %}

{% block body %}
    <h2>Watchlist</h2>

    <div class="list-wrapper">
        {% for watched in listings %}
        <a href="{% url "listing" title=watched.listing.title %}">
            <div class="listing-wrapper">
                <div class="img-wrapper">
                    <img src="{{ watched.listing.image }}">
                </div>
                <div class="listing-info">
                    <h3>{{ watched.listing.title }}</h3>
                    <h5>Category: {{ watched.listing.category }}</h5>
                    <h5>Posted By {{ watched.listing.user }} at {{ watched.listing.date_posted }}</h5>
                    <p>{{ watched.listing.description }}</p>
                    {% if watched.listing.bids.all %}
                        <h6>Current Price: {{ watched.listing.bids.first.amount }}</h6>
                    {% else %}
                        <h6>Current Price: {{ watched.listing.starting_bid }}</h6>
                    {% endif %}
                </div>
                <form action="{% url "watchlist_delete" %}" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="title" value="{{ watched.listing.title }}">
                    <input class="btn btn-danger" type="submit" value="Remove from Watchlist">
                </form>
            </div>
        </a>
        {% endfor %}
    </div>
{% endblock %}